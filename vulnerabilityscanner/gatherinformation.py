import nmap3
import json

class Hostinformation():
    def __init__(self, host):
        self.host = host

    def portOpen(self):
        port_list = []
        nmap = nmap3.NmapHostDiscovery()
        results = nmap.nmap_portscan_only(self.host, args="-Pn")
        ports = results[self.host]['ports']
        for port in ports:
            port_list.append(port['portid'])
        return port_list

    def osDetection(self):
        operatingSystem = []
        nmap = nmap3.Nmap()
        results = nmap.nmap_os_detection(self.host)
        os = results[self.host]['osmatch']
        for o in os:
            operatingSystem.append(o)
        return operatingSystem

    def serviceRunning(self):
        services = []
        nmap = nmap3.NmapHostDiscovery()
        results = nmap.nmap_portscan_only(self.host, args="-sV")
        ports = results[self.host]['ports']
        for port in ports:
            services.append(port['service'])
        return services
