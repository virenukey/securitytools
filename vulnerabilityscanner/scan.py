from CheckHostAlive import CheckHostAlive
from gatherinformation import Hostinformation

print("Enter/Paste hosts to scan (can be multiline)..")
hosts = []
while True:
    line = input()
    if not line:
        con = str(input("Do you want to continue entering hosts (Enter yes, if want to continue): "))
        y = {"y", "yes", "Yes", "YES", "Y"}
        if con in y:
           continue
        else:
           break
    else:
        hosts.append(line)

alive = []
dead = []

for host in hosts:
    result = CheckHostAlive.probeAlive(host)
    if result == 0:
        alive.append(host)
    else:
        dead.append(host)

if dead:
    print("dead hosts %s" %(",".join(dead)))

print("alive hosts %s" %(",".join(alive)))

for host in alive:
    h = Hostinformation(host)
    openPorts = h.portOpen()
    print("Ports open in host %s are %s" %(host, ",".join(openPorts)))
    os = h.osDetection()
    print("Operating system for host %s is %s" %(host, os[0]['name']))
    services = h.serviceRunning()
    cust_services = []
    for service in services:
        new_ser = {}
        if 'name' in service:
            new_ser['name'] = service['name']
        if 'product' in service:
            new_ser['product'] = service['product']
        cust_services.append(new_ser)
    for ser in cust_services:
        if 'product' in ser:
            print("Found service name %s for product %s" %(ser['name'], ser['product']))
        else:
            print("Found service name %s without product" %(ser['name']))
